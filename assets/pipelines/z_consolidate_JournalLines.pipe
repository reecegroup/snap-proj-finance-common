{"asset_type":"Pipeline","path":"/Reece-Dev/-Finance/Common/z_consolidate_JournalLines","name":"z_consolidate_JournalLines","owner":"snaplogic.support@reece.com.au","time_updated":"2022-01-31T03:43:28.839000","class_version":9,"snap_map":{"11111111-1111-1111-1111-000000000000":{"instance_id":"11111111-1111-1111-1111-000000000000","class_id":"com-snaplogic-snaps-flow-router","property_map":{"info":{"notes":{},"label":{"value":"Consolidate Journal Lines ?"}},"view_serial":100,"input":{"input0":{"label":{"value":"Do"},"view_type":{"value":"document"}}},"settings":{"routes":{"value":[{"expression":{"expression":true,"value":"($.get('consolidate','').toLowerCase() != 'y') || ($.get('filename','') != 'GlInterface.csv')"},"outputViewName":{"value":"Do Nothing"}},{"expression":{"expression":true,"value":"($.get('consolidate','').toLowerCase() == 'y') && ($.get('filename','') == 'GlInterface.csv')"},"outputViewName":{"value":"Do Something"}}]},"execution_mode":{"value":"Validate & Execute"},"firstMatch":{"value":true}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"label":{"value":"Do Nothing"},"view_type":{"value":"document"}},"output1":{"label":{"value":"Do Something"},"view_type":{"value":"document"}}}},"class_version":2},"11111111-1111-1111-1111-000000000004":{"class_id":"com-snaplogic-snaps-flow-union","instance_id":"11111111-1111-1111-1111-000000000004","property_map":{"info":{"notes":{},"label":{"value":"Return"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"Did Nothing"}},"input1":{"view_type":{"value":"document"},"label":{"value":"Did Something"}}},"settings":{"execution_mode":{"value":"Validate & Execute"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"Rows"}}}},"class_version":2},"11111111-1111-1111-1111-000000000003":{"instance_id":"11111111-1111-1111-1111-000000000003","class_id":"com-snaplogic-snaps-transform-datatransform","property_map":{"info":{"notes":{},"label":{"value":"Consolidate Journal Lines"}},"view_serial":100,"input":{"input0":{"label":{"value":"input0"},"view_type":{"value":"document"}}},"settings":{"nullSafeAccess":{"value":false},"passThrough":{"value":true},"execution_mode":{"value":"Validate & Execute"},"transformations":{"value":{"mappingTable":{"value":[{"targetPath":{"value":"$rows"},"expression":{"expression":true,"value":"$rows.map(r=> ''.concat(r['effectiveDateOfTransaction'].replace(/\\//g,'').trim(), r['segment1'].trim(), r['segment2'].trim(), r['segment3'].trim(),r['segment4'].trim())).filter((x,y,z)=> z.indexOf(x) == y).map(grp=> {'groupLineId': grp, 'jnl': $rows.filter((x,y,z)=> (''.concat(x['effectiveDateOfTransaction'].replace(/\\//g,'').trim(), x['segment1'].trim(), x['segment2'].trim(), x['segment3'].trim(),x['segment4'].trim()) == grp) && (parseFloat(x['enteredDebitAmount']) > 0))}) .concat($rows.map(r=> ''.concat(r['effectiveDateOfTransaction'].replace(/\\//g,'').trim(), r['segment1'].trim(), r['segment2'].trim(), r['segment3'].trim(),r['segment4'].trim())).filter((x,y,z)=> z.indexOf(x) == y).map(grp=> {'groupLineId': grp, 'jnl': $rows.filter((x,y,z)=> (''.concat(x['effectiveDateOfTransaction'].replace(/\\//g,'').trim(), x['segment1'].trim(), x['segment2'].trim(), x['segment3'].trim(),x['segment4'].trim()) == grp) && (parseFloat(x['enteredCreditAmount']) > 0))})) .filter((x,y,z)=> x['jnl'].length > 0) .map( l=> {'groupLineId': l['groupLineId']}.merge(l['jnl'][0]).mapValues((v, k)=> (['enteredDebitAmount','enteredCreditAmount'].indexOf(k) != -1) ? ( l['jnl'].map(x=> parseFloat(x[k])).reduceRight((a, b) => a + b, 0)): (v))).map(r=> r.filter((v,k)=> k != 'groupLineId'))"}}]},"mappingRoot":{"value":"$"}}}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":4},"11111111-1111-1111-1111-000000000001":{"class_id":"com-snaplogic-snaps-transform-datatransform","instance_id":"11111111-1111-1111-1111-000000000001","property_map":{"info":{"notes":{},"label":{"value":"Root ($)"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"nullSafeAccess":{"value":false},"passThrough":{"value":true},"execution_mode":{"value":"Validate & Execute"},"transformations":{"value":{"mappingTable":{"value":[{"expression":{"expression":true,"value":"$consolidate"},"targetPath":{"value":null}}]},"mappingRoot":{"value":"$"}}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":4},"11111111-1111-1111-1111-000000000002":{"class_id":"com-snaplogic-snaps-transform-datatransform","instance_id":"11111111-1111-1111-1111-000000000002","property_map":{"info":{"notes":{},"label":{"value":"Update columns"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"nullSafeAccess":{"value":false},"passThrough":{"value":true},"execution_mode":{"value":"Validate & Execute"},"transformations":{"value":{"mappingTable":{"value":[{"expression":{"expression":true,"value":"$.get('rows',[]).map(r=> r.mapValues((v,k)=> (['segment6','attribute8'].indexOf(k) != -1) ? ((k == 'segment6') ? ('000000') : ('')) : (v)))"},"targetPath":{"value":"$rows"}},{"expression":{"expression":true,"value":"$consolidate"},"targetPath":{"value":null}}]},"mappingRoot":{"value":"$"}}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":4}},"property_map":{"info":{"notes":{"value":null},"label":{},"purpose":{"value":null},"pipeline_doc_uri":{"value":null},"author":{"value":"michael.mandal@reece.com.au"}},"settings":{"imports":{"value":[]},"error_param_table":{"value":[]},"param_table":{"value":[]},"error_pipeline":{"expression":false,"value":null}},"error":{"error_behavior":{"value":"none"}},"input":{"11111111-1111-1111-1111-000000000000_input0":{"view_type":{"value":"document"},"label":{"value":"Consolidate Journal Lines ? - Do"}}},"output":{"11111111-1111-1111-1111-000000000004_output0":{"label":{"value":"Return - Rows"},"view_type":{"value":"document"}}}},"render_map":{"pan_x_num":0,"default_snaplex":null,"scale_ratio":1,"detail_map":{"11111111-1111-1111-1111-000000000001":{"grid_x_int":3,"index":null,"recommendation_id":null,"output":{},"source":"","grid_y_int":1,"rot_tail_int":0,"error":{},"input":{},"rot_int":0},"11111111-1111-1111-1111-000000000000":{"grid_x_int":2,"input":{},"index":null,"recommendation_id":null,"source":"snap catagory","grid_y_int":1,"rot_tail_int":0,"error":{},"output":{"output1":{"dx_int":0,"rot_int":0,"dy_int":1}},"rot_int":0},"11111111-1111-1111-1111-000000000004":{"grid_x_int":5,"index":null,"recommendation_id":null,"output":{},"source":"snap catagory","grid_y_int":1,"rot_tail_int":0,"error":{},"input":{"input1":{"dx_int":0,"rot_int":0,"dy_int":1}},"rot_int":0},"11111111-1111-1111-1111-000000000002":{"grid_x_int":3,"index":null,"recommendation_id":null,"output":{},"source":"snap catagory","grid_y_int":2,"rot_tail_int":0,"error":{},"input":{},"rot_int":0},"11111111-1111-1111-1111-000000000003":{"grid_x_int":4,"index":null,"recommendation_id":null,"output":{},"source":"snap catagory","grid_y_int":2,"rot_tail_int":0,"error":{},"input":{},"rot_int":0}},"pan_y_num":0},"class_id":"com-snaplogic-pipeline","link_map":{"link110":{"src_view_id":"output1","dst_view_id":"input0","src_id":"11111111-1111-1111-1111-000000000000","dst_id":"11111111-1111-1111-1111-000000000002"},"link115":{"src_view_id":"output0","dst_view_id":"input1","src_id":"11111111-1111-1111-1111-000000000003","dst_id":"11111111-1111-1111-1111-000000000004"},"link114":{"src_view_id":"output0","dst_view_id":"input0","src_id":"11111111-1111-1111-1111-000000000002","dst_id":"11111111-1111-1111-1111-000000000003"},"link117":{"src_view_id":"output0","dst_view_id":"input0","src_id":"11111111-1111-1111-1111-000000000000","dst_id":"11111111-1111-1111-1111-000000000001"},"link118":{"src_view_id":"output0","dst_view_id":"input0","src_id":"11111111-1111-1111-1111-000000000001","dst_id":"11111111-1111-1111-1111-000000000004"}},"target_runtime":"standard"}